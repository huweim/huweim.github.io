<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Ubuntu多版本CUDA,GCC切换 - Cory Code</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="Ubuntu多版本CUDA,GCC切换"><meta itemprop=description content="Ubuntu多版本CUDA,GCC切换 切换CUDA9.0和CUDA10.0 保证多个CUDA版本共存的前提是NVIDIA的驱动都能够支持你所安装的CUDA版本，所以驱动的版本尽可能高，越新的驱动支持的CUDA版本越多，博主的430能够支持9.0和10.0。
在先前安装的CUDA的过程中，大家一般都会选择生成cuda-x.0文件夹的软链接/usr/local/cuda，这个文件夹是实际安装的cuda-x.0文件夹的链接，不包含实际文件，是方便系统设置环境变量直接调用cuda的，安装多个版本的CUDA，然后利用软链接就可以实现版本切换。
 理解这个软链接，用到了很多次  Step 1 更换软链接 不过之前环境变量用的 cuda11.1 的地址而非软链接，现在替换成软链接
sudo rm -rf /usr/local/cuda #删除之前生成的软链接 sudo ln -s /home/huweim/cuda/toolkit/4.2/cuda /usr/local/cuda #生成新的软链接 sudo ln -s /usr/local/cuda-11.1 /usr/local/cuda	#使用11.1版本 2 Check 环境变量的地址 export CUDA_INSTALL_PATH=/usr/local/cuda/ export PATH=$PATH:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:$CUDA_INSTALL_PATH/bin:$MPI_ROOT/bin export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$CUDA_INSTALL_PATH/lib64	#这个不用改 export NVIDIA_COMPUTE_SDK_LOCATION=~/cuda/sdk/4.2 3 查看版本信息 上述步骤全部没问题就可以弹出版本信息了，source ~/.bashrc 或者重启终端
nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2012 NVIDIA Corporation Built on Thu_Apr__5_00:24:31_PDT_2012 Cuda compilation tools, release 4.2, V0.2.1221 4. Bug 4.1 sh: 1: nvopencc: Permission denied 解决方法"><meta itemprop=datePublished content="2021-11-14T22:07:35+08:00"><meta itemprop=dateModified content="2021-11-14T22:07:35+08:00"><meta itemprop=wordCount content="231"><meta itemprop=keywords content=","><meta property="og:title" content="Ubuntu多版本CUDA,GCC切换"><meta property="og:description" content="Ubuntu多版本CUDA,GCC切换 切换CUDA9.0和CUDA10.0 保证多个CUDA版本共存的前提是NVIDIA的驱动都能够支持你所安装的CUDA版本，所以驱动的版本尽可能高，越新的驱动支持的CUDA版本越多，博主的430能够支持9.0和10.0。
在先前安装的CUDA的过程中，大家一般都会选择生成cuda-x.0文件夹的软链接/usr/local/cuda，这个文件夹是实际安装的cuda-x.0文件夹的链接，不包含实际文件，是方便系统设置环境变量直接调用cuda的，安装多个版本的CUDA，然后利用软链接就可以实现版本切换。
 理解这个软链接，用到了很多次  Step 1 更换软链接 不过之前环境变量用的 cuda11.1 的地址而非软链接，现在替换成软链接
sudo rm -rf /usr/local/cuda #删除之前生成的软链接 sudo ln -s /home/huweim/cuda/toolkit/4.2/cuda /usr/local/cuda #生成新的软链接 sudo ln -s /usr/local/cuda-11.1 /usr/local/cuda	#使用11.1版本 2 Check 环境变量的地址 export CUDA_INSTALL_PATH=/usr/local/cuda/ export PATH=$PATH:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:$CUDA_INSTALL_PATH/bin:$MPI_ROOT/bin export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$CUDA_INSTALL_PATH/lib64	#这个不用改 export NVIDIA_COMPUTE_SDK_LOCATION=~/cuda/sdk/4.2 3 查看版本信息 上述步骤全部没问题就可以弹出版本信息了，source ~/.bashrc 或者重启终端
nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2012 NVIDIA Corporation Built on Thu_Apr__5_00:24:31_PDT_2012 Cuda compilation tools, release 4.2, V0.2.1221 4. Bug 4.1 sh: 1: nvopencc: Permission denied 解决方法"><meta property="og:type" content="article"><meta property="og:url" content="https://huweim.github.io/posts/%E7%BC%96%E7%A8%8B_ubuntu%E5%A4%9A%E7%89%88%E6%9C%ACcudagcc%E5%88%87%E6%8D%A2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-14T22:07:35+08:00"><meta property="article:modified_time" content="2021-11-14T22:07:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ubuntu多版本CUDA,GCC切换"><meta name=twitter:description content="Ubuntu多版本CUDA,GCC切换 切换CUDA9.0和CUDA10.0 保证多个CUDA版本共存的前提是NVIDIA的驱动都能够支持你所安装的CUDA版本，所以驱动的版本尽可能高，越新的驱动支持的CUDA版本越多，博主的430能够支持9.0和10.0。
在先前安装的CUDA的过程中，大家一般都会选择生成cuda-x.0文件夹的软链接/usr/local/cuda，这个文件夹是实际安装的cuda-x.0文件夹的链接，不包含实际文件，是方便系统设置环境变量直接调用cuda的，安装多个版本的CUDA，然后利用软链接就可以实现版本切换。
 理解这个软链接，用到了很多次  Step 1 更换软链接 不过之前环境变量用的 cuda11.1 的地址而非软链接，现在替换成软链接
sudo rm -rf /usr/local/cuda #删除之前生成的软链接 sudo ln -s /home/huweim/cuda/toolkit/4.2/cuda /usr/local/cuda #生成新的软链接 sudo ln -s /usr/local/cuda-11.1 /usr/local/cuda	#使用11.1版本 2 Check 环境变量的地址 export CUDA_INSTALL_PATH=/usr/local/cuda/ export PATH=$PATH:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:$CUDA_INSTALL_PATH/bin:$MPI_ROOT/bin export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$CUDA_INSTALL_PATH/lib64	#这个不用改 export NVIDIA_COMPUTE_SDK_LOCATION=~/cuda/sdk/4.2 3 查看版本信息 上述步骤全部没问题就可以弹出版本信息了，source ~/.bashrc 或者重启终端
nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2012 NVIDIA Corporation Built on Thu_Apr__5_00:24:31_PDT_2012 Cuda compilation tools, release 4.2, V0.2.1221 4. Bug 4.1 sh: 1: nvopencc: Permission denied 解决方法"><link href="https://fonts.googleapis.com/css?family=Playfair+Display:700" rel=stylesheet type=text/css><link rel=stylesheet type=text/css media=screen href=https://huweim.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://huweim.github.io/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://huweim.github.io/css/dark.css><script src=https://huweim.github.io/js/feather.min.js></script>
<script src=https://huweim.github.io/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://huweim.github.io/>Cory Code</a></h1><div class=site-description><p>Minimal and Clean <a href=https://github.com/athul/hugo-ink>blog theme for Hugo</a></p><nav class="nav social"><ul class=flat><li><a href=https://github.com/huweim title=GitHub><i data-feather=github></i></a></li><li><a href=https://twitter.com/athulcajay/ title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://gitlab.com/athul/ title=GitLab><i data-feather=gitlab></i></a></li><li><a href=# class=scheme-toggle id=scheme-toggle></a></li></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/categories/>Categories</a></li><li><a href=/archives>Archives</a></li><li><a href=/tags>Tags</a></li><li><a href=/about/>About</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>14</span>
<span class=rest>Nov 2021</span></div></div><div class=matter><h1 class=title>Ubuntu多版本CUDA,GCC切换</h1></div></div><div class=markdown><h1 id=ubuntu多版本cudagcc切换>Ubuntu多版本CUDA,GCC切换</h1><h1 id=切换cuda90和cuda100>切换CUDA9.0和CUDA10.0</h1><p>保证多个CUDA版本共存的前提是NVIDIA的驱动都能够支持你所安装的CUDA版本，所以驱动的版本尽可能高，越新的驱动支持的CUDA版本越多，博主的430能够支持9.0和10.0。</p><p>在先前安装的CUDA的过程中，大家一般都会选择生成cuda-x.0文件夹的软链接/usr/local/cuda，这个文件夹是实际安装的cuda-x.0文件夹的链接，不包含实际文件，是方便系统设置环境变量直接调用cuda的，安装多个版本的CUDA，然后利用软链接就可以实现版本切换。</p><ul><li>理解这个软链接，用到了很多次</li></ul><h2 id=step>Step</h2><h3 id=1-更换软链接>1 更换软链接</h3><p>不过之前环境变量用的 cuda11.1 的地址而非软链接，现在替换成软链接</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo rm -rf /usr/local/cuda  <span class=c1>#删除之前生成的软链接</span>
</span></span><span class=line><span class=cl>sudo ln -s /home/huweim/cuda/toolkit/4.2/cuda /usr/local/cuda <span class=c1>#生成新的软链接</span>
</span></span><span class=line><span class=cl>sudo ln -s /usr/local/cuda-11.1 /usr/local/cuda	<span class=c1>#使用11.1版本</span>
</span></span></code></pre></div><h3 id=2-check-环境变量的地址>2 Check 环境变量的地址</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>CUDA_INSTALL_PATH</span><span class=o>=</span>/usr/local/cuda/
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:<span class=nv>$CUDA_INSTALL_PATH</span>/bin:<span class=nv>$MPI_ROOT</span>/bin
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LD_LIBRARY_PATH</span><span class=o>=</span><span class=nv>$LD_LIBRARY_PATH</span>:<span class=nv>$CUDA_INSTALL_PATH</span>/lib64	<span class=c1>#这个不用改</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>NVIDIA_COMPUTE_SDK_LOCATION</span><span class=o>=</span>~/cuda/sdk/4.2
</span></span></code></pre></div><h3 id=3-查看版本信息>3 查看版本信息</h3><p>上述步骤全部没问题就可以弹出版本信息了，<code>source ~/.bashrc</code> 或者重启终端</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nvcc: NVIDIA <span class=o>(</span>R<span class=o>)</span> Cuda compiler driver
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>c<span class=o>)</span> 2005-2012 NVIDIA Corporation
</span></span><span class=line><span class=cl>Built on Thu_Apr__5_00:24:31_PDT_2012
</span></span><span class=line><span class=cl>Cuda compilation tools, release 4.2, V0.2.1221
</span></span></code></pre></div><h3 id=4-bug>4. Bug</h3><h4 id=41-sh-1-nvopencc-permission-denied>4.1 sh: 1: nvopencc: Permission denied</h4><p>解决方法</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo chmod -R <span class=m>777</span> /usr/local/cuda
</span></span></code></pre></div><h1 id=切换gcc-g-9---5>切换gcc, g++ 9 -> 5</h1><p>Reference</p><ul><li><a href=https://blog.csdn.net/EternallyAccompany/article/details/108865331>https://blog.csdn.net/EternallyAccompany/article/details/108865331</a></li></ul><p>linux上可以gcc多版本共存，可以通过<strong>修改软链接</strong>的方式选择自己要用的gcc版本，该方法简单方便，可以随时依据自己的需求将gcc降级或升级，解决不同的软件要求不同的环境的问题。</p><p>apt-get安装gcc、g++，默认下载最新版本的，此时ubuntu里的gcc和g++版本均为9。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>1. sudo apt-get install gcc
</span></span><span class=line><span class=cl>2. sudo apt-get install g++
</span></span><span class=line><span class=cl>3. gcc -v   //查看的版本为9.0.0
</span></span><span class=line><span class=cl>4. g++ -v   //查看的版本为9.0.0
</span></span></code></pre></div><h2 id=1-软件源>1. 软件源</h2><p>打开sources.list</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo gedit /etc/apt/sources.list
</span></span></code></pre></div><p>Add</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deb http://dk.archive.ubuntu.com/ubuntu/ xenial main
</span></span><span class=line><span class=cl>deb http://dk.archive.ubuntu.com/ubuntu/ xenial universe
</span></span></code></pre></div><p>Update</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update
</span></span></code></pre></div><h2 id=2-安装gcc5-g5>2. 安装gcc5, g++5</h2><p>apt-get 安装gcc、g++ 5版本。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install g++-5 gcc-5sudo apt-get -f install   <span class=c1>#if need </span>
</span></span></code></pre></div><p>2021-07-09 10:40:42 gcc5版本又出现了一些问题，找<a href=https://blog.csdn.net/qq_42566274/article/details/106399531>教程</a>安装了 gcc4.8 版本，这个文章里面说最低 4.7 版本，那就先用 4.8 版本试试 gpgpu-sim 能不能 work</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install gcc-4.8sudo apt-get install g++-4.8
</span></span></code></pre></div><h2 id=3-查看>3. 查看</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls /usr/bin/gcc*ls /usr/bin/g++*
</span></span></code></pre></div><h2 id=4-设置优先级>4. 设置优先级</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-5 90sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-9 80sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-5 90sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-9 <span class=m>80</span>
</span></span></code></pre></div><p>增加</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8 95sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8 <span class=m>95</span>
</span></span></code></pre></div><p>成功配置上了 gcc 4.8</p><blockquote><p>由于gpgpusim必须使用gcc4.7及以前的版本，而修改自己的电脑系统可能带来不方便，因此使用docker来运行程序，docker在运行程序时，性能损失大概在10%以内，但也比vbox快多了。</p></blockquote><p>好吧，必须使用 gcc4.7 以前的版本</p><h2 id=5-选择gccg版本>5. 选择gcc/g++版本</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo update-alternatives --config gccsudo update-alternatives --config g++
</span></span></code></pre></div><p>输入编号选择gcc/g++版本</p><p>:warning: <em>gcc/g++版本须保持一致</em></p><h2 id=6-check-版本>6. Check 版本</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcc -vg++ -v
</span></span></code></pre></div></div><div class=tags><ul class=flat><li><a href=/tags/></a></li></ul></div></div></div><div class="footer wrapper"><nav class=nav><div>2022 © Athul | <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script></body></html>