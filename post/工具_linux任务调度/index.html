<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage data-theme=light><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Linux任务调度 - Weiming Hu
</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=color-scheme content="light dark"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=generator content="Hugo 0.140.2"><link rel=canonical href=https://huweim.github.io/post/%E5%B7%A5%E5%85%B7_linux%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/><meta name=author content="Cory"><meta name=description content="0. 前言 记录一下 Linux 中 fg、bg、jobs、&、ctrl + z 等相关指令对任务进程的操作。
也正好借此机会学习一下进程（process）的概念
1. Process 1.0 进程类型 前台进程（交互式进程） 这些进程由终端会话初始化和控制。换句话说，需要有一个连接到系统中的用户来启动这样的进程；它们不是作为系统功能/服务的一部分自动启动。 后台进程 1.1 并发执行 To run commands concurrently you can use the & command separator
"><meta name=keywords content="Linux"><meta property="og:url" content="https://huweim.github.io/post/%E5%B7%A5%E5%85%B7_linux%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/"><meta property="og:site_name" content="Weiming Hu"><meta property="og:title" content="Linux任务调度"><meta property="og:description" content="0. 前言 记录一下 Linux 中 fg、bg、jobs、&、ctrl + z 等相关指令对任务进程的操作。
也正好借此机会学习一下进程（process）的概念
1. Process 1.0 进程类型 前台进程（交互式进程） 这些进程由终端会话初始化和控制。换句话说，需要有一个连接到系统中的用户来启动这样的进程；它们不是作为系统功能/服务的一部分自动启动。 后台进程 1.1 并发执行 To run commands concurrently you can use the & command separator"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-11-29T23:00:09+08:00"><meta property="article:modified_time" content="2022-03-16T08:44:28+00:00"><meta property="article:tag" content="Linux"><meta itemprop=name content="Linux任务调度"><meta itemprop=description content="0. 前言 记录一下 Linux 中 fg、bg、jobs、&、ctrl + z 等相关指令对任务进程的操作。
也正好借此机会学习一下进程（process）的概念
1. Process 1.0 进程类型 前台进程（交互式进程） 这些进程由终端会话初始化和控制。换句话说，需要有一个连接到系统中的用户来启动这样的进程；它们不是作为系统功能/服务的一部分自动启动。 后台进程 1.1 并发执行 To run commands concurrently you can use the & command separator"><meta itemprop=datePublished content="2021-11-29T23:00:09+08:00"><meta itemprop=dateModified content="2022-03-16T08:44:28+00:00"><meta itemprop=wordCount content="2675"><meta itemprop=keywords content="Linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux任务调度"><meta name=twitter:description content="0. 前言 记录一下 Linux 中 fg、bg、jobs、&、ctrl + z 等相关指令对任务进程的操作。
也正好借此机会学习一下进程（process）的概念
1. Process 1.0 进程类型 前台进程（交互式进程） 这些进程由终端会话初始化和控制。换句话说，需要有一个连接到系统中的用户来启动这样的进程；它们不是作为系统功能/服务的一部分自动启动。 后台进程 1.1 并发执行 To run commands concurrently you can use the & command separator"><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/style.min.1acfe3c0bf85aa6c451ba764236bb3ab12c22cd38eee8ecc8fac33defcc7156d.css integrity="sha256-Gs/jwL+FqmxFG6dkI2uzqxLCLNOO7o7Mj6wz3vzHFW0=" media=screen crossorigin=anonymous><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><script>(function(){var e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e)})()</script></head><body><div id=back-to-top></div><header class=site-header><div class=desktop-header><div class=desktop-header-logo><a href=/ class=logo>Weiming Hu</a></div><nav class=desktop-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=https://huweim.github.io/>Home</a></li><li class=menu-item><a class=menu-item-link href=https://huweim.github.io/post>All posts</a></li><li class=menu-item><a class=menu-item-link href=https://huweim.github.io/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=https://huweim.github.io/archives>Archives</a></li><li class=menu-item><a class=menu-item-link href=https://huweim.github.io/tags>Tags</a></li><li class=menu-item><a class=menu-item-link href=https://huweim.github.io/about/>About</a></li><li class=menu-item><a class="theme-toggle menu-item-link" href=javascript:void(0);><svg aria-hidden="true" class="lucide lucide-sun hi-svg-inline theme-icon-light" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg><svg aria-hidden="true" class="lucide lucide-moon hi-svg-inline theme-icon-dark" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M12 3a6 6 0 009 9 9 9 0 11-9-9z"/></svg></a></li><li class=menu-item><a class=menu-item-link href=https://huweim.github.io/index.xml rel="noopener alternate" type=application/rss+xml title=rss target=_blank><svg aria-hidden="true" class="lucide lucide-rss hi-svg-inline icon--rss" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></li></ul></nav></div><div class=mobile-header><div id=mobile-navbar class=mobile-navbar><div id=mobile-navbar-icon class=mobile-navbar-icon><svg aria-hidden="true" class="lucide lucide-menu hi-svg-inline icon--menu" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg></div><div class=mobile-navbar-logo><a href=/ class=logo>Weiming Hu</a></div></div><div id=mobile-menu-close-modal class=mobile-menu-close-modal></div><nav id=mobile-menu class=mobile-menu><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=https://huweim.github.io/>Home</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://huweim.github.io/post>All posts</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://huweim.github.io/categories/>Categories</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://huweim.github.io/archives>Archives</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://huweim.github.io/tags>Tags</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://huweim.github.io/about/>About</a></li><li class=mobile-menu-item><a class="theme-toggle menu-item-link" href=javascript:void(0);><svg aria-hidden="true" class="lucide lucide-sun hi-svg-inline theme-icon-light" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg><svg aria-hidden="true" class="lucide lucide-moon hi-svg-inline theme-icon-dark" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M12 3a6 6 0 009 9 9 9 0 11-9-9z"/></svg></a></li><li class=mobile-menu-item><a class=menu-item-link href=https://huweim.github.io/index.xml rel="noopener alternate" type=application/rss+xml title=rss target=_blank><svg aria-hidden="true" class="lucide lucide-rss hi-svg-inline icon--rss" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></li></ul></nav></div></header><main id=main class="main pico container"><div class=content-wrapper><aside class=sidebar></aside><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Linux任务调度</h1><div class=post-meta-list><div class="post-meta-item post-meta-author"><svg aria-hidden="true" class="lucide lucide-user-round-pen hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M2 21a8 8 0 0110.821-7.487"/><path d="M21.378 16.626a1 1 0 00-3.004-3.004l-4.01 4.012a2 2 0 00-.506.854l-.837 2.87a.5.5.0 00.62.62l2.87-.837a2 2 0 00.854-.506z"/><circle cx="10" cy="8" r="5"/></svg>
Cory</div><div class="post-meta-item post-meta-time"><svg aria-hidden="true" class="lucide lucide-calendar-days hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/></svg>
<time datetime=2021-11-29>2021-11-29
</time><span class="post-meta-item post-meta-lastmod">(LastMod:
2022-03-16)</span></div><div class=post-meta__right><span class=post-meta-more>2675 words -
6 min read</span><div class="post-meta-item post-meta-category"><a href=https://huweim.github.io/categories/%E5%B7%A5%E5%85%B7/>工具</a></div></div></div></header><div class=post-content><h1 id=0-前言>0. 前言</h1><p>记录一下 <code>Linux</code> 中 <code>fg</code>、<code>bg</code>、<code>jobs</code>、<code>&</code>、<code>ctrl + z</code> 等相关指令对任务进程的操作。</p><p>也正好借此机会学习一下进程（process）的概念</p><h1 id=1-process>1. Process</h1><h2 id=10-进程类型>1.0 进程类型</h2><ul><li>前台进程（交互式进程）<ul><li>这些进程由终端会话初始化和控制。换句话说，需要有一个连接到系统中的用户来启动这样的进程；它们不是作为系统功能/服务的一部分自动启动。</li></ul></li><li>后台进程</li></ul><h2 id=11-并发执行>1.1 并发执行</h2><p>To run commands concurrently you can use the <code>&</code> command separator</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>~$ command1 &amp; command2 &amp; command3</span></span></code></pre></div></div><p>This will start <code>command1</code>, then runs it in the background. The same with <code>command2</code>. Then it starts <code>command3</code> normally.</p><blockquote><p>这样的话 command3 是在前台运行</p></blockquote><p>The output of all commands will be garbled together, but if that is not a problem for you, that would be the solution.</p><p>If you want to have a separate look at the output later, you can pipe the output of each command into <code>tee</code>, which lets you specify a file to mirror the output to.</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><pre tabindex=0><code class=language-bsh data-lang=bsh>~$ command1 | tee 1.log &amp; command2 | tee 2.log &amp; command3 | tee 3.log</code></pre></div><blockquote><p>这样可以分别在对应的 log 中查看不同 command output，我也是这么做的</p><p>加&的作用其实就是将命令放到后台执行</p></blockquote><h3 id=111-终止并发执行的后台进程>1.1.1 终止并发执行的后台进程</h3><ul><li>方法一： 通过 <code>jobs</code> 命令查看任务号（假设为 <code>num</code>），然后执行：<code>kill %num</code></li><li>方法二： 通过 <code>ps</code> 命令查看任务的进程号（<code>PID</code>，假设为 <code>pid</code>），然后执行：<code>kill pid</code></li></ul><h2 id=12-进程及性能分析>1.2 进程及性能分析</h2><h3 id=121-进程状态>1.2.1 进程状态</h3><ul><li>R： <strong>RUNNING & RUNNABLE</strong>，正在运行或在运行队列中等待</li><li>S：<strong>INTERRRUPTABLE_SLEEP</strong>，休眠中, 受阻, 在等待某个条件的形成或接受到 signal</li><li>D：<strong>UNINTERRUPTABLE_SLEEP</strong>，不可中断（usually IO）</li><li>T：<strong>STOPPED</strong>，ctrl + z 进入这个状态</li><li>Z：<strong>ZOMBIE</strong>，进程已终止, 但进程描述符存在, 直到父进程调用wait4()系统调用后释放</li></ul><h3 id=122-查看进程状态-ps>1.2.2 查看进程状态 ps</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ps -aux <span style=color:#75715e>#显示所有包含其他使用者的行程 </span></span></span></code></pre></div></div><p><strong>%CPU</strong>：该 process 使用掉的 CPU 资源百分比</p><p><strong>%MEM</strong>：该 process 所占用的物理内存百分比</p><p><strong>TTY</strong> ：该 process 是在那个终端机上面运作，若与终端机无关，则显示 ?，另外， tty1-tty6 是本机上面的登入者程序，若为 pts/0 等等的，则表示为由网络连接进主机的程序。</p><p><strong>STAT</strong>：该程序目前的状态，主要的状态参考 <strong>1.2进程状态</strong></p><p><strong>START</strong>：该 process 被触发启动的时间</p><p><strong>TIME</strong> ：该 process 实际使用 CPU 运作的时间</p><h3 id=123-性能分析-top>1.2.3 性能分析 top</h3><h5 id=信息查看实例>信息查看实例</h5><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>top - 19:39:49 up <span style=color:#ae81ff>77</span> days,  8:54,  <span style=color:#ae81ff>0</span> users,  load average: 5.00, 5.00, 5.00
</span></span><span style=display:flex><span><span style=color:#75715e># 系统当前时间；开机到现在77days 8h 54 mins；0 users 在线；系统1分钟、5分钟、15分钟的CPU负载信息</span>
</span></span><span style=display:flex><span>Tasks:  <span style=color:#ae81ff>13</span> total,   <span style=color:#ae81ff>1</span> running,  <span style=color:#ae81ff>12</span> sleeping,   <span style=color:#ae81ff>0</span> stopped,   <span style=color:#ae81ff>0</span> zombie
</span></span><span style=display:flex><span>%Cpu<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>: 20.9 us,  0.0 sy,  0.0 ni, 79.1 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span><span style=color:#75715e># %us：用户态进程占用CPU时间百分比，不包含renice值为负的任务占用的CPU的时间。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># %sy：内核占用CPU时间百分比</span>
</span></span><span style=display:flex><span><span style=color:#75715e># %ni：改变过优先级的进程占用CPU的百分比</span>
</span></span><span style=display:flex><span><span style=color:#75715e># %id：空闲CPU时间百分比</span>
</span></span><span style=display:flex><span><span style=color:#75715e># %wa：等待I/O的CPU时间百分比</span>
</span></span><span style=display:flex><span><span style=color:#75715e># %hi：CPU硬中断时间百分比</span>
</span></span><span style=display:flex><span><span style=color:#75715e># %si：CPU软中断时间百分比</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 这里显示数据是所有cpu的平均值，如果想看每一个cpu的处理情况，按1即可；折叠，再次按1</span>
</span></span><span style=display:flex><span>MiB Mem :  48192.1 total,  25777.1 free,   2605.3 used,  19809.7 buff/cache
</span></span><span style=display:flex><span>MiB Swap:  19530.0 total,  19491.7 free,     38.2 used.  45002.0 avail Mem</span></span></code></pre></div></div><h5 id=查看单个进程使用cpu情况>查看单个进程使用CPU情况</h5><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ top -p pid
</span></span><span style=display:flex><span>$ ps -aux <span style=color:#75715e>#这个好像更加方便一点</span></span></span></code></pre></div></div><h2 id=13-为什么top查看只有1-running其他sleeping>1.3 为什么top查看只有1 running，其他sleeping?</h2><h5 id=stackoverflow回答>Stackoverflow回答</h5><p>There is no correlation between CPU usage as reported by <code>top</code> and process state. The <a href=http://linux.die.net/man/1/top>man page</a> says (<em>emphasis</em> mine):</p><blockquote><p><strong>%CPU</strong> &ndash; CPU usage</p><p>The task&rsquo;s share of the elapsed CPU time <em>since the last screen update</em>, expressed as a percentage of total CPU time.</p></blockquote><p>So, your process indeed used a huge amount of processor time since the last screen update. It is sleeping, yes, but that&rsquo;s because the currently running process is <code>top</code> itself (which makes sense, since it&rsquo;s currently updating the screen).</p><h5 id=理解>理解</h5><p>这个1 running 就是 top process 本身，其他的 process 其实也是在运行的。每次 top 面板更新时活跃 process 正好是 top，所以 only 1 running。但是查看详细信息可以看到其实是在运行的。</p><h1 id=2-进程调度>2. 进程调度</h1><h2 id=21-基本用法>2.1. 基本用法</h2><h3 id=211--和-jobs-指令>2.1.1 <code>&</code> 和 <code>jobs</code> 指令</h3><p><code>&</code> 用在一个命令的最后，可以把这个命令转换为<strong>后台运行</strong>的任务进程。</p><p><code>jobs</code> 查看当前终端有多少在后台运行的进程。</p><ul><li><code>jobs</code> 命令执行的结果，<code>＋</code> 表示是一个当前的作业，<code>-</code> 减号表示是一个当前作业之后的一个作业。</li><li><code>jobs -l</code> 选项可显示所有任务的进程号 <code>pid</code></li><li><code>jobs</code> 的状态可以是 <code>running</code>，<code>stopped</code>，<code>terminated</code>。但是如果任务进程被终止了（<code>kill</code>），当前的终端环境中也就删除了任务的进程标识；也就是说 <strong>jobs 命令显示的是当前 shell 环境中后台正在运行或者被挂起的任务进程信息</strong></li></ul><h3 id=213-fg-和-bg-指令>2.1.3 <code>fg</code> 和 <code>bg</code> 指令</h3><p><code>fg</code> 将后台任务进程调至<strong>前台</strong>继续运行，如果后台中有多个任务进程，可以用 <code>fg %num</code> 将选中的任务进程调至前台。</p><p><code>bg</code> 将挂起的任务进程重新启动运行，如果有多个暂停的任务进程，可以用 <code>bg %num</code> 将选中的任务进程启动运行。</p><blockquote><p><code>%num</code> 是通过 <code>jobs</code> 命令查到的后台正在执行的任务的序号（不是 <code>pid</code>）</p></blockquote><p>&#x2757; 使用 ispass_run.sh 的时候最好使用 <code>fg</code>，如果使用 <code>bg</code> 则无法再次挂起，<del>猜测是因为</del>，原因是 <code>ctrl + z</code> 是用于挂起前台进程，使用 <code>stop</code> 将其挂起即可</p><blockquote><p>使用 stop 2，好像也无法将其挂起？</p></blockquote><h2 id=22-进程的挂起>2.2. 进程的挂起</h2><h3 id=221-后台进程的挂起>2.2.1 后台进程的挂起</h3><ul><li>在 <code>solaris</code> 中通过 <code>stop</code> 命令执行，通过 <code>jobs</code> 命令查看任务号（假设为 <code>num</code>），然后执行：<code>stop %num</code></li><li>在 <code>redhat</code> 中，不存在 <code>stop</code> 命令，可通过执行命令 <code>kill -stop PID</code>，将进程挂起</li></ul><h3 id=222-前台进程的挂起-ctrlz>2.2.2 前台进程的挂起 ctrl+z</h3><p><code>ctrl + z</code>：可以将一个正在s前台执行的任务放到后台运行，并且挂起</p><h2 id=23-挂起进程重新运行-bg-fg>2.3. 挂起进程重新运行 bg, fg</h2><ul><li>通过 <code>bg %num</code> 即可将挂起的任务进程的状态由 <code>stopped</code> 改为 <code>running</code>，仍在后台运行</li><li>通过 <code>fg %num</code> 即可将挂起的任务进程转为前台执行</li></ul><h2 id=24-进程的终止>2.4. 进程的终止</h2><h3 id=241-后台进程的终止-kill-killall>2.4.1 后台进程的终止 kill, killall</h3><ul><li>方法一： 通过 <code>jobs</code> 命令查看任务号（假设为 <code>num</code>），然后执行：<code>kill %num</code></li><li>方法二： 通过 <code>ps</code> 命令查看任务的进程号（<code>PID</code>，假设为 <code>pid</code>），然后执行：<code>kill pid</code></li><li><code>killall CMD</code>：通过进程名 kill 感觉比根据 pid 方便很多</li></ul><h3 id=242-前台进程的终止-ctrlc>2.4.2 前台进程的终止 ctrl+c</h3><p>执行 <code>ctrl+c</code> 即可终止前台执行任务进程</p><blockquote><p>假设要后台运行 <code>xmms</code>，可通过命令：<code>xmms &</code>。但万一你运行程序时忘记使用 <code>&</code> 了，又不想重新执行，你可以先使用 <code>ctrl+z</code> 挂起任务进程，然后敲入<code>bg</code> 命令，这样任务进程就在后台继续运行了。</p></blockquote><h1 id=3-查看cpu信息>3. 查看CPU信息</h1><ul><li>查看物理CPU个数</li></ul><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat /proc/cpuinfo| grep <span style=color:#e6db74>&#34;physical id&#34;</span>| sort| uniq| wc -l</span></span></code></pre></div></div><ul><li>查看每个物理CPU中core的个数(即核数)</li></ul><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat /proc/cpuinfo| grep <span style=color:#e6db74>&#34;cpu cores&#34;</span>| uniq</span></span></code></pre></div></div><ul><li>查看逻辑CPU的个数</li></ul><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat /proc/cpuinfo| grep <span style=color:#e6db74>&#34;processor&#34;</span>| wc -l</span></span></code></pre></div></div><h1 id=4-why-jobs-看不到后台-process>4. Why <code>jobs</code> 看不到后台 process</h1><h2 id=41-关闭终端造成孤儿进程>4.1 关闭终端造成孤儿进程</h2><blockquote><p>jobs是查看当前后台作业（进程），是获取本次bash下的后台作业。
当本次终端退出后，后台作业变成<strong>孤儿进程</strong>，孤儿进程有系统父进程接管。
当再次连接终端时，<strong>原作业</strong>与<strong>当前终端</strong>，不存在关系父子关系，故看不到进程。
但是原作业，会在系统中一致运行，直到完成或被停止。
这就是为什么终端退出后，jobs看不到的原因了</p></blockquote><h2 id=42-nohup>4.2 nohup</h2><h3 id=421->4.2.1 &</h3><p>守护进程貌似跟nohup + &方式启动的进程差不多。都可以实现与终端的无关联。</p><p>& 可以让进程在后台运行，ctrl + C 无法终端，对 SIGINT 信号免疫，但是直接关闭 shell 后进程会消失。& 后台没有那么硬 :)，对 SIGHUP 信号不免疫</p><h3 id=422-nohup--作用>4.2.2 nohup 作用</h3><p>nohup 的作用是忽略 SIGHUP 信号，也就是不挂断地运行</p><p>&和nohup没有半毛钱的关系， 要让进程真正不受shell中Ctrl C和shell关闭的影响， 那该怎么办呢？ 那就用nohup ./start.sh &吧， 两全其美。</p><h1 id=reference>Reference</h1><p><a href=https://ehlxr.me/2017/01/18/Linux-%E4%B8%AD-fg%E3%80%81bg%E3%80%81jobs%E3%80%81-%E6%8C%87%E4%BB%A4/>https://ehlxr.me/2017/01/18/Linux-%E4%B8%AD-fg%E3%80%81bg%E3%80%81jobs%E3%80%81-%E6%8C%87%E4%BB%A4/</a></p><p><a href=https://www.cnblogs.com/machangwei-8/p/10391440.html>https://www.cnblogs.com/machangwei-8/p/10391440.html</a></p></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>Cory</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2022-03-16</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><footer class=post-footer><div class=post-tags><a href=https://huweim.github.io/tags/linux/>Linux</a></div><nav class=post-nav><a class=prev href=/post/%E7%BC%96%E7%A8%8B_python%E5%A4%84%E7%90%86%E8%BE%93%E5%87%BAlog%E4%BF%A1%E6%81%AF%E5%B9%B6%E7%BB%98%E5%9B%BE/><i class=iconfont><svg aria-hidden="true" class="lucide lucide-chevron-left hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="m15 18-6-6 6-6"/></svg>
</i><span class="prev-text nav-default">Python处理输出log信息并绘图</span>
<span class="prev-text nav-mobile">Prev</span>
</a><a class=next href=/post/%E7%BC%96%E7%A8%8B_ubuntu%E5%A4%9A%E7%89%88%E6%9C%ACcudagcc%E5%88%87%E6%8D%A2/><span class="next-text nav-default">Ubuntu多版本CUDA,GCC切换</span>
<span class="prev-text nav-mobile">Next</span>
<i class=iconfont><svg aria-hidden="true" class="lucide lucide-chevron-right hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="m9 18 6-6-6-6"/></svg></i></a></nav></footer></article></div><nav class=toc id=toc><div class=toc-title>Table of Contents</div><div class="toc-content custom-scrollbar"><nav id=TableOfContents><ul><li><a href=#0-前言>0. 前言</a></li><li><a href=#1-process>1. Process</a><ul><li><a href=#10-进程类型>1.0 进程类型</a></li><li><a href=#11-并发执行>1.1 并发执行</a><ul><li><a href=#111-终止并发执行的后台进程>1.1.1 终止并发执行的后台进程</a></li></ul></li><li><a href=#12-进程及性能分析>1.2 进程及性能分析</a><ul><li><a href=#121-进程状态>1.2.1 进程状态</a></li><li><a href=#122-查看进程状态-ps>1.2.2 查看进程状态 ps</a></li><li><a href=#123-性能分析-top>1.2.3 性能分析 top</a><ul><li><ul><li><a href=#信息查看实例>信息查看实例</a></li><li><a href=#查看单个进程使用cpu情况>查看单个进程使用CPU情况</a></li></ul></li></ul></li></ul></li><li><a href=#13-为什么top查看只有1-running其他sleeping>1.3 为什么top查看只有1 running，其他sleeping?</a><ul><li><ul><li><ul><li><a href=#stackoverflow回答>Stackoverflow回答</a></li><li><a href=#理解>理解</a></li></ul></li></ul></li></ul></li></ul></li><li><a href=#2-进程调度>2. 进程调度</a><ul><li><a href=#21-基本用法>2.1. 基本用法</a><ul><li><a href=#211--和-jobs-指令>2.1.1 <code>&</code> 和 <code>jobs</code> 指令</a></li><li><a href=#213-fg-和-bg-指令>2.1.3 <code>fg</code> 和 <code>bg</code> 指令</a></li></ul></li><li><a href=#22-进程的挂起>2.2. 进程的挂起</a><ul><li><a href=#221-后台进程的挂起>2.2.1 后台进程的挂起</a></li><li><a href=#222-前台进程的挂起-ctrlz>2.2.2 前台进程的挂起 ctrl+z</a></li></ul></li><li><a href=#23-挂起进程重新运行-bg-fg>2.3. 挂起进程重新运行 bg, fg</a></li><li><a href=#24-进程的终止>2.4. 进程的终止</a><ul><li><a href=#241-后台进程的终止-kill-killall>2.4.1 后台进程的终止 kill, killall</a></li><li><a href=#242-前台进程的终止-ctrlc>2.4.2 前台进程的终止 ctrl+c</a></li></ul></li></ul></li><li><a href=#3-查看cpu信息>3. 查看CPU信息</a></li><li><a href=#4-why-jobs-看不到后台-process>4. Why <code>jobs</code> 看不到后台 process</a><ul><li><a href=#41-关闭终端造成孤儿进程>4.1 关闭终端造成孤儿进程</a></li><li><a href=#42-nohup>4.2 nohup</a><ul><li><a href=#421->4.2.1 &</a></li><li><a href=#422-nohup--作用>4.2.2 nohup 作用</a></li></ul></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></nav></div></main><footer id=footer class=site-footer><div class=social-icon-links><a href=mailto:huwm1@shanghaitech.edu.cn rel="me noopener" class=social-icon-link title=email><svg aria-hidden="true" class="icon hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 1451 1024" width="1em" xlink="http://www.w3.org/1999/xlink"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z"/></svg>
</a><a href=http://localhost:1313 rel="me noopener" class=social-icon-link title=linkedin target=_blank><svg aria-hidden="true" class="icon hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 1024 1024" width="1em" xlink="http://www.w3.org/1999/xlink"><path d="M872.405333 872.618667H720.768V635.008c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333.0-91.136 61.653333-91.136 125.397334v241.792H398.976V384H544.64v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667.0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667.0 01-88.021333-88.106666A88.064 88.064.0 11227.712 317.141333zm76.032 555.477334H151.68V384h152.064v488.618667zM948.266667.0h-872.704C33.792.0.0 33.024.0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667.0 948.138667.0h.128z"/></svg>
</a><a href=https://github.com/huweim rel="me noopener" class=social-icon-link title=github target=_blank><svg aria-hidden="true" class="icon hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 1024 1024" width="1em" xlink="http://www.w3.org/1999/xlink"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04C242.005334 929.664 211.968 830.08 211.968 830.08 188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg>
</a><a href=https://www.zhihu.com/people/hu-wei-ming-31-86 rel="me noopener" class=social-icon-link title=zhihu target=_blank><svg aria-hidden="true" class="icon hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 1024 1024" width="1em" xlink="http://www.w3.org/1999/xlink"><path d="M351.791182 562.469462h192.945407c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262h159.282726s-.86367-67.402109-18.578124-67.402109-279.979646.0-279.979646.0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461s24.62791 5.832845 36.941354.0c12.313443-5.832845 68.050885-25.924439 84.252893-103.69571h86.570681c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262H109.86113c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449H279.868105c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513.0.0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-.055259.185218 167.855986 193.263655s22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-.045025.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"/><path d="M584.918753 182.033893v668.840094h70.318532l28.807093 80.512708 121.875768-80.512708h153.600307L959.520453 182.033893h-374.6017zM887.150192 778.934538h-79.837326l-99.578949 65.782216-23.537066-65.782216h-24.855084L659.341766 256.673847h227.807403V778.934538z"/></svg>
</a><a href=https://huweim.github.io/index.xml rel="noopener alternate" type=application/rss+xml class=social-icon-link title=rss target=_blank><svg aria-hidden="true" class="lucide lucide-rss hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span><span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a>
</span><span class=copyright-year>&copy;
2020 -
2025
<span class=heart><i class=iconfont><svg aria-hidden="true" class="lucide lucide-heart hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5.0 0016.5 3c-1.76.0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5.0 002 8.5c0 2.3 1.5 4.05 3 5.5l7 7z"/></svg>
</i></span><span class=author>Weiming Hu</span></span></div></footer><script type=text/javascript src=/js/main.eb94e793601239645bc98e36c443aef1b210646ccb43e2217ea949a0212e0ed1.js integrity="sha256-65Tnk2ASOWRbyY42xEOu8bIQZGzLQ+IhfqlJoCEuDtE=" crossorigin=anonymous></script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script></body></html>